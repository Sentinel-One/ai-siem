{
  "formats": [
    {
      "format": ".*${parse=gron}$",
      "skipNumericConversion": true
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      // Audit v2 event
      {
        "predicate": "AuditLogID matches '.*' && ActionTimestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Audit Logs V2",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountName",
              "to": "actor.user.account.name"
            }
          }, {
            "rename": {
              "from": "unmapped.ActionDescription",
              "to": "status_detail"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceScope",
              "to": "entity.group.name"
            }
          }, {
            "rename": {
              "from": "unmapped.ActionResult",
              "to": "status"
            }
          }, {
            "copy": {
              "from": "status",
              "to": "status_id"
            }
          }, {
            "cast": {
              "field": "status_id",
              "type": "enum",
              "enum": {
                "success": 1,
                "failure": 2
              },
              "enum_default": 99
            }
          }, {
            "rename": {
              "from": "unmapped.ActionTimestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.ActionType",
              "to": "metadata.log_name"
            }
          }, {
            "copy": {
              "from": "metadata.log_name",
              "to": "activity_name"
            }
          }, {
            "cast": {
              "field": "activity_name",
              "type": "enum",
              "enum": {
                "view": "Read",
                "create": "Create",
                "delete": "Delete",
                "update": "Update"
              }
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "activity_id"
            }
          }, {
            "cast": {
              "field": "activity_id",
              "type": "enum",
              "enum": {
                "Read": 2,
                "Create": 1,
                "Update": 3,
                "Delete": 4
              },
              "enum_default": 99
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "type_uid"
            }
          }, {
            "cast": {
              "field": "type_uid",
              "type": "enum",
              "enum": {
                "Read": 300402,
                "Create": 300401,
                "Update": 300403,
                "Delete": 300404
              },
              "enum_default": 300499
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "type_name"
            }
          }, {
            "cast": {
              "field": "type_name",
              "type": "enum",
              "enum": {
                "Read": "Entity Management: Read",
                "Create": "Entity Management: Create",
                "Update": "Entity Management: Update",
                "Delete": "Entity Management: Delete"
              },
              "enum_default": "Entity Management: Other"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorEmail",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorIPAddress",
              "to": "device.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorType",
              "to": "actor.user.type"
            }
          }, {
            "copy": {
              "from": "actor.user.type",
              "to": "actor.user.type_id"
            }
          }, {
            "cast": {
              "field": "actor.user.type_id",
              "type": "enum",
              "enum": {
                "user": 1,
                "system": 3
              },
              "enum_default": 99
            }
          }, {
            "copy": {
              "from": "unmapped.AuditLogID",
              "to": "metadata.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.ResourceID",
              "to": "entity.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Raw.cf_ray_id",
              "to": "http_request.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Raw.method",
              "to": "http_request.http_method"
            }
          }, {
            "rename": {
              "from": "unmapped.Raw.status_code",
              "to": "http_response.code"
            }
          }, {
            "cast": {
              "field": "http_response.code",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.Raw.uri",
              "to": "http_request.url.path"
            }
          }, {
            "rename": {
              "from": "unmapped.Raw.user_agent",
              "to": "http_request.user_agent"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceProduct",
              "to": "entity.type"
            }
          }, {
            "rename": {
              "from": "unmapped.ZoneID",
              "to": "src_endpoint.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ZoneName",
              "to": "src_endpoint.zone"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Identity & Access Management",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 3,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Entity Management",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 3004,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // DNS event
      {
        "predicate": "QueryName matches '.*' && Timestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "DNS logs",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.ColoCode",
              "to": "dst_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.QueryName",
              "to": "query.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.QueryType",
              "to": "query.type"
            }
          }, {
            "rename": {
              "from": "unmapped.ResponseCode",
              "to": "rcode_id"
            }
          }, {
            "cast": {
              "field": "rcode_id",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.Timestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "DNS Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4003,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": "DNS Activity: Query",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 400301,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Query",
              "field": "activity_name"
            }
          }, {
            "constant": {
              "value": 1,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": "Query",
              "field": "event.type"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Audit event
      {
        "predicate": "ID matches '.*' && When matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Audit Logs",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.When",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.ActionType",
              "to": "metadata.log_name"
            }
          }, {
            "copy": {
              "from": "metadata.log_name",
              "to": "activity_name"
            }
          }, {
            "cast": {
              "field": "activity_name",
              "type": "enum",
              "enum": {
                "job_create": "Create",
                "job_delete": "Delete",
                "job_update": "Update",
                "rulesets_create": "Create",
                "rulesets_delete": "Delete",
                "rulesets_update": "Update",
                "create": "Create",
                "delete": "Delete",
                "update": "Update"
              }
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "activity_id"
            }
          }, {
            "cast": {
              "field": "activity_id",
              "type": "enum",
              "enum": {
                "Read": 2,
                "Create": 1,
                "Update": 3,
                "Delete": 4
              },
              "enum_default": 99
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "type_uid"
            }
          }, {
            "cast": {
              "field": "type_uid",
              "type": "enum",
              "enum": {
                "Read": 300402,
                "Create": 300401,
                "Update": 300403,
                "Delete": 300404
              },
              "enum_default": 300499
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "type_name"
            }
          }, {
            "cast": {
              "field": "type_name",
              "type": "enum",
              "enum": {
                "Read": "Entity Management: Read",
                "Create": "Entity Management: Create",
                "Update": "Entity Management: Update",
                "Delete": "Entity Management: Delete"
              },
              "enum_default": "Entity Management: Other"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorEmail",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorIP",
              "to": "device.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ActorType",
              "to": "actor.user.type"
            }
          }, {
            "copy": {
              "from": "actor.user.type",
              "to": "actor.user.type_id"
            }
          }, {
            "cast": {
              "field": "actor.user.type_id",
              "type": "enum",
              "enum": {
                "user": 1,
                "system": 3
              },
              "enum_default": 99
            }
          }, {
            "rename": {
              "from": "unmapped.ID",
              "to": "metadata.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceID",
              "to": "entity.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceType",
              "to": "entity.type"
            }
          }, {
            "rename": {
              "from": "unmapped.OwnerID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Identity & Access Management",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 3,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Entity Management",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 3004,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // HTTP event
      {
        "predicate": "ClientRequestMethod matches '.*' && EdgeStartTimestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "HTTP Requests",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "field": "category_uid",
              "value": 4
            }
          }, {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          }, {
            "constant": {
              "field": "class_uid",
              "value": 4002
            }
          }, {
            "constant": {
              "field": "class_name",
              "value": "HTTP Activity"
            }
          }, {
            "constant": {
              "field": "metadata.version",
              "value": "1.6.0"
            }
          }, {
            "constant": {
              "field": "metadata.product.vendor_name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "metadata.profiles[0]",
              "value": "host"
            }
          }, {
            "constant": {
              "field": "metadata.profiles[1]",
              "value": "security_control"
            }
          }, {
            "constant": {
              "field": "metadata.profiles[2]",
              "value": "load_balancer"
            }
          }, {
            "constant": {
              "field": "metadata.product.name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "severity_id",
              "value": 0
            }
          }, {
            "constant": {
              "field": "connection_info.direction_id",
              "value": 0
            }
          }, {
            "constant": {
              "field": "type_uid",
              "value": 400201
            }
          }, {
            "constant": {
              "field": "type_name",
              "value": "HTTP Activity: Connect"
            }
          }, {
            "constant": {
              "field": "activity_name",
              "value": "Connect"
            }
          }, {
            "constant": {
              "field": "activity_id",
              "value": 1
            }
          }, {
            "constant": {
              "field": "event.type",
              "value": "Connect"
            }
          }, {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          }, {
            "constant": {
              "field": "dataSource.vendor",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "dataSource.name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          }, {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          }, {
            "constant": {
              "field": "observables[0].name",
              "value": "src_endpoint.ip"
            }
          }, {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          }, {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          }, {
            "constant": {
              "field": "observables[1].name",
              "value": "dst_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientCity",
              "to": "src_endpoint.location.city"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientCountry",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientDeviceType",
              "to": "device.type"
            }
          }, {
            "copy": {
              "from": "device.type",
              "to": "device.type_id"
            }
          }, {
            "cast": {
              "field": "device.type_id",
              "type": "enum",
              "enum": {
                "unknown": 0,
                "Unknown": 0,
                "server": 1,
                "Server": 1,
                "desktop": 2,
                "Desktop": 2,
                "laptop": 3,
                "Laptop": 3,
                "tablet": 4,
                "Tablet": 4,
                "mobile": 5,
                "Mobile": 5,
                "virtual": 6,
                "Virtual": 6,
                "iot": 7,
                "IOT": 7,
                "browser": 8,
                "Browser": 8,
                "firewall": 9,
                "Firewall": 9,
                "switch": 10,
                "Switch": 10,
                "hub": 11,
                "Hub": 11,
                "router": 12,
                "Router": 12,
                "ids": 13,
                "IDS": 13,
                "ips": 14,
                "IPS": 14,
                "load balancer": 15,
                "Load Balancer": 15,
                "other": 99,
                "Other": 99
              },
              "enum_default": 99
            }
          }, {
            "copy": {
              "from": "unmapped.ClientIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientIP",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientLatitude",
              "to": "src_endpoint.location.lat"
            }
          }, {
            "cast": {
              "field": "src_endpoint.location.lat",
              "type": "float"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientLongitude",
              "to": "src_endpoint.location.long"
            }
          }, {
            "cast": {
              "field": "src_endpoint.location.long",
              "type": "float"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientMTLSAuthCertFingerprint",
              "to": "tls.certificate.fingerprints[0].value"
            }
          }, {
            "constant": {
              "field": "tls.certificate.fingerprints[0].algorithm_id",
              "value": 3
            }
          }, {
            "constant": {
              "field": "tls.certificate.issuer",
              "value": "N/A"
            }
          }, {
            "constant": {
              "field": "tls.certificate.serial_number",
              "value": "N/A"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRegionCode",
              "to": "src_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestBytes",
              "to": "http_request.length"
            }
          }, {
            "cast": {
              "field": "http_request.length",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestHost",
              "to": "http_request.url.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestMethod",
              "to": "http_request.http_method"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestPath",
              "to": "http_request.url.path"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestReferer",
              "to": "http_request.referrer"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestScheme",
              "to": "http_request.url.scheme"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestSource",
              "to": "unmapped.ClientRequestSource"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestURI",
              "to": "http_request.url.url_string"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestUserAgent",
              "to": "http_request.user_agent"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientSSLCipher",
              "to": "tls.cipher"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientSSLProtocol",
              "to": "tls.version"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientSrcPort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.EdgeEndTimestamp",
              "to": "end_time"
            }
          }, {
            "cast": {
              "field": "end_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.EdgeStartTimestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "start_time"
            }
          }, {
            "cast": {
              "field": "start_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "copy": {
              "from": "start_time",
              "to": "time"
            }
          }, {
            "rename": {
              "from": "unmapped.JA3Hash",
              "to": "tls.ja3_hash.value"
            }
          }, {
            "constant": {
              "field": "tls.ja3_hash.algorithm_id",
              "value": 1
            }
          }, {
            "rename": {
              "from": "unmapped.JA4",
              "to": "ja4_fingerprint_list[0].value"
            }
          }, {
            "constant": {
              "field": "ja4_fingerprint_list[0].type_id",
              "value": 1
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestPath",
              "to": "http_request.url.path"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestProtocol",
              "to": "http_request.version"
            }
          }, {
            "copy": {
              "from": "unmapped.LeakedCredentialCheckResult",
              "to": "actor.authorizations[0].decision"
            }
          }, {
            "copy": {
              "from": "unmapped.OriginIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginIP",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginResponseBytes",
              "to": "http_response.body_length"
            }
          }, {
            "cast": {
              "field": "http_response.body_length",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginResponseDurationMs",
              "to": "http_response.latency"
            }
          }, {
            "cast": {
              "field": "http_response.latency",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginResponseStatus",
              "to": "http_response.status"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginResponseTime",
              "to": "duration"
            }
          }, {
            "cast": {
              "field": "duration",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginSSLProtocol",
              "to": "connection_info.protocol_name"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginTLSHandshakeDurationMs",
              "to": "tls.handshake_dur"
            }
          }, {
            "cast": {
              "field": "tls.handshake_dur",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.RayID",
              "to": "metadata.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SecurityAction",
              "to": "action"
            }
          }, {
            "rename": {
              "from": "unmapped.SecurityRuleDescription",
              "to": "firewall_rule.desc"
            }
          }, {
            "rename": {
              "from": "unmapped.SecurityRuleID",
              "to": "firewall_rule.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SecuritySources[*]",
              "to": "firewall_rule.match_details[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.SmartRouteColoID",
              "to": "load_balancer.dst_endpoint.name"
            }
          }, {
            "rename": {
              "from": "unmapped.UpperTierColoID",
              "to": "load_balancer.endpoint_connections[0].code"
            }
          }, {
            "cast": {
              "field": "load_balancer.endpoint_connections[0].code",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.WAFAttackScore",
              "to": "risk_score"
            }
          }, {
            "cast": {
              "field": "risk_score",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.WorkerScriptName",
              "to": "actor.process.name"
            }
          }, {
            "rename": {
              "from": "unmapped.ZoneName",
              "to": "src_endpoint.zone"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Access requests event
      {
        "predicate": "UserUID matches '.*' && CreatedAt matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Access requests",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.Action",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.AppUUID",
              "to": "actor.app_uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Connection",
              "to": "actor.idp.name"
            }
          }, {
            "rename": {
              "from": "unmapped.Country",
              "to": "device.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.CreatedAt",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "user.email_addr"
            }
          }, {
            "copy": {
              "from": "user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.IPAddress",
              "to": "device.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.PurposeJustificationResponse",
              "to": "privileges[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.RayID",
              "to": "metadata.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.UserUID",
              "to": "user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Identity & Access Management",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 3,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "User Access Management",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 3005,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 300599,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "User Access Management: Other",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Device Posture event
      {
        "predicate": "PostureCheckName matches '.*' && Timestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Device posture results",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "constant": {
              "value": "Create",
              "field": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientVersion",
              "to": "metadata.product.feature.version"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceID",
              "to": "device.uid"
            }
          }, {
            "copy": {
              "from": "device.uid",
              "to": "finding_info.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceManufacturer",
              "to": "device.hw_info.vendor_name"
            }
          }, {
            "rename": {
              "from": "unmapped.Timestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceModel",
              "to": "device.model"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceName",
              "to": "device.name"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceSerialNumber",
              "to": "device.hw_info.serial_number"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceType",
              "to": "device.type"
            }
          }, {
            "copy": {
              "from": "device.type",
              "to": "device.type_id"
            }
          }, {
            "cast": {
              "field": "device.type_id",
              "type": "enum",
              "enum": {
                "unknown": 0,
                "Unknown": 0,
                "server": 1,
                "Server": 1,
                "desktop": 2,
                "Desktop": 2,
                "laptop": 3,
                "Laptop": 3,
                "tablet": 4,
                "Tablet": 4,
                "mobile": 5,
                "Mobile": 5,
                "virtual": 6,
                "Virtual": 6,
                "iot": 7,
                "IOT": 7,
                "browser": 8,
                "Browser": 8,
                "firewall": 9,
                "Firewall": 9,
                "switch": 10,
                "Switch": 10,
                "hub": 11,
                "Hub": 11,
                "router": 12,
                "Router": 12,
                "ids": 13,
                "IDS": 13,
                "ips": 14,
                "IPS": 14,
                "load balancer": 15,
                "Load Balancer": 15,
                "other": 99,
                "Other": 99
              },
              "enum_default": 99
            }
          }, {
            "rename": {
              "from": "unmapped.OSVersion",
              "to": "device.os.version"
            }
          }, {
            "constant": {
              "value": "N/A",
              "field": "device.os.name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.os.type_id"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyID",
              "to": "actor.authorizations[0].policy.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.UserUID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.RegistrationID",
              "to": "device.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Findings",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Application Security Posture Finding",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 2007,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 1,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 200701,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Application Security Posture Finding: Create",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Firewall event
      {
        "predicate": "RuleID matches '.*' && Kind matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Firewall events",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.Action",
              "to": "action"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientASN",
              "to": "src_endpoint.owner.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientASNDescription",
              "to": "src_endpoint.owner.account.name"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientCountry",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRefererPath",
              "to": "http_request.referrer"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestHost",
              "to": "http_request.url.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestMethod",
              "to": "http_request.http_method"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestPath",
              "to": "http_request.url.path"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestProtocol",
              "to": "http_request.version"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestQuery",
              "to": "http_request.url.query_string"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestScheme",
              "to": "http_request.url.scheme"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestUserAgent",
              "to": "http_request.user_agent"
            }
          }, {
            "rename": {
              "from": "unmapped.Description",
              "to": "firewall_rule.desc"
            }
          }, {
            "rename": {
              "from": "unmapped.EdgeColoCode",
              "to": "dst_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.EdgeResponseStatus",
              "to": "http_response.code"
            }
          }, {
            "cast": {
              "field": "http_response.code",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.Kind",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.LeakedCredentialCheckResult",
              "to": "actor.authorizations[0].decision"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginatorRayID",
              "to": "http_request.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.RayID",
              "to": "metadata.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.RuleID",
              "to": "firewall_rule.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Source",
              "to": "metadata.product.feature.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[1]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "HTTP Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4002,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 400299,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "HTTP Activity: Other",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Gateway Network event
      {
        "predicate": "SNI matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Gateway Network",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.Action",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "dst_endpoint.ip",
              "to": "observables[2].value"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIPContinentCode",
              "to": "dst_endpoint.location.continent"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIPCountryCode",
              "to": "dst_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientRequestHost",
              "to": "http_request.url.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceID",
              "to": "device.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceName",
              "to": "device.name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyID",
              "to": "actor.authorizations[0].policy.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyName",
              "to": "actor.authorizations[0].policy.name"
            }
          }, {
            "rename": {
              "from": "unmapped.ProxyEndpoint",
              "to": "src_endpoint.proxy_endpoint.name"
            }
          }, {
            "rename": {
              "from": "unmapped.RegistrationID",
              "to": "device.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.SNI",
              "to": "tls.sni"
            }
          }, {
            "constant": {
              "value": "N/A",
              "field": "tls.version"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionID",
              "to": "actor.session.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIPContinentCode",
              "to": "src_endpoint.location.continent"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIPCountryCode",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceInternalIP",
              "to": "src_endpoint.intermediate_ips[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.SourcePort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.TransportProtocol",
              "to": "connection_info.protocol_name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "connection_info.direction_id"
            }
          }, {
            "rename": {
              "from": "unmapped.UserID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.VirtualNetworkID",
              "to": "device.network_interfaces[0].uid"
            }
          }, {
            "rename": {
              "from": "unmapped.VirtualNetworkName",
              "to": "device.network_interfaces[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4001,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 400199,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity: Other",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[1].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[1].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[1].name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[2].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[2].type"
            }
          }, {
            "constant": {
              "value": "dst_endpoint.ip",
              "field": "observables[2].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Gateway DNS event
      {
        "predicate": "QueryName matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Gateway DNS",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ApplicationID",
              "to": "actor.app_uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ApplicationName",
              "to": "app_name"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.ColoCode",
              "to": "dst_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.CustomResolverResponse",
              "to": "status_detail"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceID",
              "to": "device.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceName",
              "to": "device.name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "rename": {
              "from": "unmapped.DstIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "dst_endpoint.ip",
              "to": "observables[2].value"
            }
          }, {
            "rename": {
              "from": "unmapped.DstPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceName",
              "to": "device.name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.Location",
              "to": "src_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyID",
              "to": "actor.authorizations[0].policy.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyName",
              "to": "actor.authorizations[0].policy.name"
            }
          }, {
            "rename": {
              "from": "unmapped.Protocol",
              "to": "connection_info.protocol_name"
            }
          }, {
            "constant": {
              "field": "connection_info.direction_id",
              "value": 0
            }
          }, {
            "rename": {
              "from": "unmapped.QueryTypeName",
              "to": "query.type"
            }
          }, {
            "rename": {
              "from": "unmapped.RCode",
              "to": "rcode_id"
            }
          }, {
            "cast": {
              "field": "rcode_id",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.RegistrationID",
              "to": "device.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.ResolvedIPs[*]",
              "to": "dst_endpoint.intermediate_ips[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.ResolverDecision",
              "to": "status_code"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceRecords[*].type",
              "to": "answers[*].type"
            }
          }, {
            "rename": {
              "from": "unmapped.ResourceRecords[*].data",
              "to": "answers[*].rdata"
            }
          }, {
            "rename": {
              "from": "unmapped.SrcIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.SrcIPContinentCode",
              "to": "src_endpoint.location.continent"
            }
          }, {
            "rename": {
              "from": "unmapped.SrcIPCountryCode",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.SrcPort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.UserID",
              "to": "actor.user.uid"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "DNS Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4003,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 1,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": "Query",
              "field": "activity_name"
            }
          }, {
            "constant": {
              "value": "Query",
              "field": "event.type"
            }
          }, {
            "constant": {
              "value": 400301,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "DNS Activity: Query",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[1].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[1].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[1].name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[2].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[2].type"
            }
          }, {
            "constant": {
              "value": "dst_endpoint.ip",
              "field": "observables[2].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Gateway HTTP event
      {
        "predicate": "HTTPHost matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Gateway HTTP",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Action",
              "to": "action"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "dst_endpoint.ip",
              "to": "observables[2].value"
            }
          }, {
            "rename": {
              "from": "unmapped.BlockedFileHash",
              "to": "file.hashes[0].value"
            }
          }, {
            "constant": {
              "field": "file.hashes[0].algorithm_id",
              "value": 99
            }
          }, {
            "rename": {
              "from": "unmapped.BlockedFileName",
              "to": "file.name"
            }
          }, {
            "rename": {
              "from": "unmapped.BlockedFileSize",
              "to": "file.size"
            }
          }, {
            "cast": {
              "field": "file.size",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.BlockedFileType",
              "to": "file.type"
            }
          }, {
            "constant": {
              "field": "file.type_id",
              "value": 99
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIPContinentCode",
              "to": "dst_endpoint.location.continent"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationIPCountryCode",
              "to": "dst_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyID",
              "to": "actor.authorizations[0].policy.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.PolicyName",
              "to": "actor.authorizations[0].policy.name"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.HTTPHost",
              "to": "http_request.url.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.HTTPMethod",
              "to": "http_request.http_method"
            }
          }, {
            "rename": {
              "from": "unmapped.HTTPStatusCode",
              "to": "http_response.code"
            }
          }, {
            "cast": {
              "field": "http_response.code",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.HTTPVersion",
              "to": "http_request.version"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ProxyEndpoint",
              "to": "src_endpoint.proxy_endpoint.name"
            }
          }, {
            "rename": {
              "from": "unmapped.Referer",
              "to": "http_request.referrer"
            }
          }, {
            "rename": {
              "from": "unmapped.RegistrationID",
              "to": "device.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.RequestID",
              "to": "http_request.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionID",
              "to": "actor.session.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIPContinentCode",
              "to": "src_endpoint.location.continent"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIPCountryCode",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceInternalIP",
              "to": "src_endpoint.intermediate_ips[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.SourcePort",
              "to": "dst_endpoint.port"
            }
          }, {
            "rename": {
              "from": "unmapped.URL",
              "to": "http_request.url.url_string"
            }
          }, {
            "rename": {
              "from": "unmapped.UserAgent",
              "to": "http_request.user_agent"
            }
          }, {
            "rename": {
              "from": "unmapped.UserID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.VirtualNetworkID",
              "to": "device.network_interfaces[0].uid"
            }
          }, {
            "rename": {
              "from": "unmapped.VirtualNetworkName",
              "to": "device.network_interfaces[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[1]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "HTTP Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4002,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 1,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": "Connect",
              "field": "activity_name"
            }
          }, {
            "constant": {
              "value": "Connect",
              "field": "event.type"
            }
          }, {
            "constant": {
              "value": 400201,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "HTTP Activity: Connect",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[1].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[1].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[1].name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[2].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[2].type"
            }
          }, {
            "constant": {
              "value": "dst_endpoint.ip",
              "field": "observables[2].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Network analytics | Ddos protection event
      {
        "predicate": "AttackVector matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Network Analytics Logs",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AttackID",
              "to": "malware[0].uid"
            }
          }, {
            "rename": {
              "from": "unmapped.AttackVector",
              "to": "malware[0].name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "malware[0].classification_ids[0]"
            }
          }, {
            "constant": {
              "value": "DDOS",
              "field": "malware[0].classifications[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationASN",
              "to": "dst_endpoint.autonomous_system.number"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.autonomous_system.number",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationASNName",
              "to": "dst_endpoint.autonomous_system.name"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationCountry",
              "to": "dst_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationGeoHash",
              "to": "dst_endpoint.location.geohash"
            }
          }, {
            "rename": {
              "from": "unmapped.DestinationPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.Direction",
              "to": "connection_info.direction"
            }
          }, {
            "copy": {
              "from": "connection_info.direction",
              "to": "connection_info.direction_id"
            }
          }, {
            "cast": {
              "field": "connection_info.direction_id",
              "type": "enum",
              "enum": {
                "ingress": 1,
                "egress": 2
              },
              "enum_default": 99
            }
          }, {
            "rename": {
              "from": "unmapped.IPDestinationAddress",
              "to": "dst_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "dst_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.IPDestinationSubnet",
              "to": "dst_endpoint.subnet_uid"
            }
          }, {
            "rename": {
              "from": "unmapped.IPProtocol",
              "to": "connection_info.protocol_num"
            }
          }, {
            "cast": {
              "field": "connection_info.protocol_num",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.IPProtocolName",
              "to": "connection_info.protocol_name"
            }
          }, {
            "rename": {
              "from": "unmapped.IPSourceAddress",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.IPSourceSubnet",
              "to": "src_endpoint.subnet_uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Outcome",
              "to": "status_detail"
            }
          }, {
            "rename": {
              "from": "unmapped.RuleID",
              "to": "firewall_rule.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.RuleName",
              "to": "firewall_rule.name"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceASN",
              "to": "src_endpoint.autonomous_system.number"
            }
          }, {
            "cast": {
              "field": "src_endpoint.autonomous_system.number",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceASNName",
              "to": "src_endpoint.autonomous_system.name"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceCountry",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceGeoHash",
              "to": "src_endpoint.location.geohash"
            }
          }, {
            "rename": {
              "from": "unmapped.SourcePort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.Verdict",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4001,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 400199,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity: Other",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[0].name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[1].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[1].type"
            }
          }, {
            "constant": {
              "value": "dst_endpoint.ip",
              "field": "observables[1].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Network Session event
      {
        "predicate": "EgressIP matches '.*' && SessionStartTime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Zero Trust Network Session Logs",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.BytesReceived",
              "to": "traffic.bytes_in"
            }
          }, {
            "cast": {
              "field": "traffic.bytes_in",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.BytesSent",
              "to": "traffic.bytes_out"
            }
          }, {
            "cast": {
              "field": "traffic.bytes_out",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTLSCipher",
              "to": "tls.client_ciphers[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTLSHandshakeDurationMs",
              "to": "tls.handshake_dur"
            }
          }, {
            "cast": {
              "field": "tls.handshake_dur",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTLSVersion",
              "to": "tls.version"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceID",
              "to": "device.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.DeviceName",
              "to": "device.name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "device.type_id"
            }
          }, {
            "rename": {
              "from": "unmapped.EgressColoName",
              "to": "src_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.EgressRuleID",
              "to": "firewall_rule.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.EgressRuleName",
              "to": "firewall_rule.name"
            }
          }, {
            "rename": {
              "from": "unmapped.Email",
              "to": "actor.user.email_addr"
            }
          }, {
            "copy": {
              "from": "actor.user.email_addr",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.IngressColoName",
              "to": "dst_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "dst_endpoint.ip",
              "to": "observables[2].value"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.Protocol",
              "to": "connection_info.protocol_name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "connection_info.direction_id"
            }
          }, {
            "rename": {
              "from": "unmapped.RegistrationID",
              "to": "device.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.ResolvedFQDN",
              "to": "dst_endpoint.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionStartTime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "copy": {
              "from": "time",
              "to": "actor.session.created_time"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionEndTime",
              "to": "actor.session.expiration_time"
            }
          }, {
            "cast": {
              "field": "actor.session.expiration_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionID",
              "to": "actor.session.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.SourceInternalIP",
              "to": "src_endpoint.intermediate_ips[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.SourcePort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.UserID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.VirtualNetworkID",
              "to": "device.network_interfaces[0].uid"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[1]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4001,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": 6,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": "Traffic",
              "field": "activity_name"
            }
          }, {
            "constant": {
              "value": "Traffic",
              "field": "event.type"
            }
          }, {
            "constant": {
              "value": 400106,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity: Traffic",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[1].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[1].type"
            }
          }, {
            "constant": {
              "value": "src_endpoint.ip",
              "field": "observables[1].name"
            }
          }, {
            "constant": {
              "value": 5,
              "field": "observables[0].type_id"
            }
          }, {
            "constant": {
              "value": "Email Address",
              "field": "observables[0].type"
            }
          }, {
            "constant": {
              "value": "actor.user.email_addr",
              "field": "observables[0].name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "observables[2].type_id"
            }
          }, {
            "constant": {
              "value": "IP Address",
              "field": "observables[2].type"
            }
          }, {
            "constant": {
              "value": "dst_endpoint.ip",
              "field": "observables[2].name"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Email Security alert
      {
        "predicate": "From matches '.*' && Timestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Email Security Alerts",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AlertID",
              "to": "email.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.CC[*]",
              "to": "email.cc[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.CCName[*]",
              "to": "email.cc_mailboxes[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.FinalDisposition",
              "to": "disposition"
            }
          }, {
            "copy": {
              "from": "disposition",
              "to": "disposition_id"
            }
          }, {
            "cast": {
              "field": "disposition_id",
              "type": "enum",
              "enum": {
                "unset": 0,
                "malicious": 15,
                "suspicious": 15
              },
              "enum_default": 99
            }
          }, {
            "rename": {
              "from": "unmapped.From",
              "to": "email.from"
            }
          }, {
            "rename": {
              "from": "unmapped.FromName",
              "to": "email.from_mailbox"
            }
          }, {
            "rename": {
              "from": "unmapped.Links[*]",
              "to": "email.urls[*].url_string"
            }
          }, {
            "rename": {
              "from": "unmapped.MessageID",
              "to": "email.message_uid"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginalSender",
              "to": "email.sender"
            }
          }, {
            "rename": {
              "from": "unmapped.ReplyTo",
              "to": "email.reply_to_list[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.ReplyToName",
              "to": "email.reply_to_mailboxes[0]"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPEnvelopeFrom",
              "to": "src_endpoint.owner.email_addr"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPHeloServerIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPHeloServerIPAsName",
              "to": "src_endpoint.autonomous_system.name"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPHeloServerIPAsNumber",
              "to": "src_endpoint.autonomous_system.number"
            }
          }, {
            "cast": {
              "field": "src_endpoint.autonomous_system.number",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPHeloServerIPGeo",
              "to": "src_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.SMTPHeloServerName",
              "to": "src_endpoint.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.Subject",
              "to": "email.subject"
            }
          }, {
            "copy": {
              "from": "unmapped.ThreatCategories[*]",
              "to": "metadata.labels[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.Timestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.To[*]",
              "to": "email.to[*]"
            }
          }, {
            "rename": {
              "from": "unmapped.ToName[*]",
              "to": "email.to_mailboxes[*]"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Email Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4009,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 3,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": "Scan",
              "field": "activity_name"
            }
          }, {
            "constant": {
              "value": "Scan",
              "field": "event.type"
            }
          }, {
            "constant": {
              "value": 400903,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": "Email Activity: Scan",
              "field": "type_name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "direction_id"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // DLP forensic copies event
      {
        "predicate": "ForensicCopyID matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "DLP Forensic Copies",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ForensicCopyID",
              "to": "finding_info.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.GatewayRequestID",
              "to": "metadata.event_code"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.Phase",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.TriggeredRuleID",
              "to": "firewall_rule.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[1]"
            }
          }, {
            "constant": {
              "value": "Findings",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 2,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Data Security Finding",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 2006,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 200699,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": "Data Security Finding: Other",
              "field": "type_name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // Spectrum event
      {
        "predicate": "Event matches '.*' && Timestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "Spectrum events",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "value": "security",
              "field": "dataSource.category"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "dataSource.vendor"
            }
          }, {
            "rename": {
              "from": "unmapped.Application",
              "to": "app_name"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientAsn",
              "to": "src_endpoint.autonomous_system.number"
            }
          }, {
            "cast": {
              "field": "src_endpoint.autonomous_system.number",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientBytes",
              "to": "traffic.bytes_in"
            }
          }, {
            "cast": {
              "field": "traffic.bytes_in",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientCountry",
              "to": "src_endpoint.location.country"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientIP",
              "to": "src_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "src_endpoint.ip",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientMatchedIpFirewall",
              "to": "firewall_rule.name"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientPort",
              "to": "src_endpoint.port"
            }
          }, {
            "cast": {
              "field": "src_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientProto",
              "to": "connection_info.protocol_name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "connection_info.direction_id"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTcpRtt",
              "to": "tls.handshake_dur"
            }
          }, {
            "cast": {
              "field": "tls.handshake_dur",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTlsCipher",
              "to": "tls.cipher"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTlsClientHelloServerName",
              "to": "tls.sni"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTlsProtocol",
              "to": "tls.version"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientTlsStatus",
              "to": "status_detail"
            }
          }, {
            "rename": {
              "from": "unmapped.ColoCode",
              "to": "src_endpoint.location.region"
            }
          }, {
            "rename": {
              "from": "unmapped.ConnectTimestamp",
              "to": "start_time"
            }
          }, {
            "cast": {
              "field": "start_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.DisconnectTimestamp",
              "to": "end_time"
            }
          }, {
            "cast": {
              "field": "end_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.Event",
              "to": "activity_name"
            }
          }, {
            "copy": {
              "from": "activity_name",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginBytes",
              "to": "traffic.bytes_out"
            }
          }, {
            "cast": {
              "field": "traffic.bytes_out",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginIP",
              "to": "dst_endpoint.ip"
            }
          }, {
            "copy": {
              "from": "dst_endpoint.ip",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.OriginPort",
              "to": "dst_endpoint.port"
            }
          }, {
            "cast": {
              "field": "dst_endpoint.port",
              "type": "int"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.ProxyProtocol",
              "to": "proxy_connection_info.protocol_name"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "proxy_connection_info.direction_id"
            }
          }, {
            "rename": {
              "from": "unmapped.Timestamp",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.vendor_name"
            }
          }, {
            "constant": {
              "value": "Cloudflare",
              "field": "metadata.product.name"
            }
          }, {
            "constant": {
              "value": "1.6.0",
              "field": "metadata.version"
            }
          }, {
            "constant": {
              "value": "host",
              "field": "metadata.profiles[0]"
            }
          }, {
            "constant": {
              "value": "security_control",
              "field": "metadata.profiles[1]"
            }
          }, {
            "constant": {
              "value": "network_proxy",
              "field": "metadata.profiles[2]"
            }
          }, {
            "constant": {
              "field": "observables[0].type_id",
              "value": 2
            }
          }, {
            "constant": {
              "field": "observables[0].type",
              "value": "IP Address"
            }
          }, {
            "constant": {
              "field": "observables[0].name",
              "value": "src_endpoint.ip"
            }
          }, {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          }, {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          }, {
            "constant": {
              "field": "observables[1].name",
              "value": "src_endpoint.ip"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "category_name"
            }
          }, {
            "constant": {
              "value": 4,
              "field": "category_uid"
            }
          }, {
            "constant": {
              "value": "Network Activity",
              "field": "class_name"
            }
          }, {
            "constant": {
              "value": 4001,
              "field": "class_uid"
            }
          }, {
            "constant": {
              "value": 99,
              "field": "activity_id"
            }
          }, {
            "constant": {
              "value": 400199,
              "field": "type_uid"
            }
          }, {
            "constant": {
              "value": 0,
              "field": "severity_id"
            }
          }, {
            "constant": {
              "value": "Network Activity: Other",
              "field": "type_name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // SSH event
      {
        "predicate": "PTY matches '.*' && Datetime matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "SSH Logs",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "field": "category_uid",
              "value": 4
            }
          }, {
            "constant": {
              "field": "category_name",
              "value": "Network Activity"
            }
          }, {
            "constant": {
              "field": "class_uid",
              "value": 4007
            }
          }, {
            "constant": {
              "field": "class_name",
              "value": "SSH Activity"
            }
          }, {
            "constant": {
              "field": "metadata.version",
              "value": "1.6.0"
            }
          }, {
            "constant": {
              "field": "metadata.product.vendor_name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "metadata.product.name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "metadata.profiles[a]",
              "value": "host"
            }
          }, {
            "constant": {
              "field": "severity_id",
              "value": 0
            }
          }, {
            "constant": {
              "field": "type_uid",
              "value": 400799
            }
          }, {
            "constant": {
              "field": "type_name",
              "value": "SSH Activity: Other"
            }
          }, {
            "constant": {
              "field": "activity_id",
              "value": 99
            }
          }, {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          }, {
            "constant": {
              "field": "dataSource.vendor",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "dataSource.name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "observables[0].type_id",
              "value": 5
            }
          }, {
            "constant": {
              "field": "observables[0].type",
              "value": "Email Address"
            }
          }, {
            "constant": {
              "field": "observables[0].name",
              "value": "actor.user.email_addr"
            }
          }, {
            "constant": {
              "field": "observables[1].type_id",
              "value": 2
            }
          }, {
            "constant": {
              "field": "observables[1].type",
              "value": "IP Address"
            }
          }, {
            "constant": {
              "field": "observables[1].name",
              "value": "src_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.AccountID",
              "to": "actor.user.account.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.ClientAddress",
              "to": "src_endpoint.ip"
            }
          }, {
            "rename": {
              "from": "unmapped.ClientAddress",
              "to": "observables[1].value"
            }
          }, {
            "rename": {
              "from": "unmapped.Datetime",
              "to": "metadata.original_time"
            }
          }, {
            "copy": {
              "from": "metadata.original_time",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.Error",
              "to": "status_detail"
            }
          }, {
            "rename": {
              "from": "unmapped.ProgramFinishDatetime",
              "to": "end_time"
            }
          }, {
            "cast": {
              "field": "end_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.ProgramID",
              "to": "metadata.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.ProgramStartDatetime",
              "to": "start_time"
            }
          }, {
            "cast": {
              "field": "start_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "copy": {
              "from": "unmapped.ProgramType",
              "to": "activity_name"
            }
          }, {
            "rename": {
              "from": "unmapped.ProgramType",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.ServerAddress",
              "to": "dst_endpoint.hostname"
            }
          }, {
            "rename": {
              "from": "unmapped.TargetID",
              "to": "dst_endpoint.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionFinishDatetime",
              "to": "actor.session.expiration_time"
            }
          }, {
            "cast": {
              "field": "actor.session.expiration_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionID",
              "to": "actor.session.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.SessionStartDatetime",
              "to": "actor.session.created_time"
            }
          }, {
            "cast": {
              "field": "actor.session.created_time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "copy": {
              "from": "unmapped.UserEmail",
              "to": "actor.user.email_addr"
            }
          }, {
            "rename": {
              "from": "unmapped.UserEmail",
              "to": "observables[0].value"
            }
          }, {
            "rename": {
              "from": "unmapped.UserID",
              "to": "actor.user.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.Username",
              "to": "actor.user.name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      },
      // CASB Findings
      {
        "predicate": "AssetLink matches '.*' && DetectedTimestamp matches '.*'",
        "transformations": [
          {
            "rename_tree": {
              "from": "",
              "to": "unmapped"
            }
          }, {
            "constant": {
              "value": "CASB Findings",
              "field": "dataSource.cloudflare_dataset"
            }
          }, {
            "constant": {
              "field": "category_uid",
              "value": 2
            }
          }, {
            "constant": {
              "field": "category_name",
              "value": "Findings"
            }
          }, {
            "constant": {
              "field": "class_uid",
              "value": 2006
            }
          }, {
            "constant": {
              "field": "class_name",
              "value": "Data Security Finding"
            }
          }, {
            "constant": {
              "field": "metadata.version",
              "value": "1.6.0"
            }
          }, {
            "constant": {
              "field": "metadata.product.vendor_name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "metadata.product.name",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "type_uid",
              "value": 200699
            }
          }, {
            "constant": {
              "field": "type_name",
              "value": "Data Security Finding: Other"
            }
          }, {
            "constant": {
              "field": "activity_id",
              "value": 99
            }
          }, {
            "constant": {
              "field": "dataSource.category",
              "value": "security"
            }
          }, {
            "constant": {
              "field": "dataSource.vendor",
              "value": "Cloudflare"
            }
          }, {
            "constant": {
              "field": "dataSource.name",
              "value": "Cloudflare"
            }
          }, {
            "rename": {
              "from": "unmapped.AssetDisplayName",
              "to": "file.name"
            }
          }, {
            "rename": {
              "from": "unmapped.AssetExternalID",
              "to": "file.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.AssetLink",
              "to": "file.path"
            }
          }, {
            "constant": {
              "field": "file.type_id",
              "value": 0
            }
          }, {
            "copy": {
              "from": "unmapped.DetectedTimestamp",
              "to": "metadata.original_time"
            }
          }, {
            "rename": {
              "from": "unmapped.DetectedTimestamp",
              "to": "time"
            }
          }, {
            "cast": {
              "field": "time",
              "type": "datetime",
              "format": "yyyy-MM-dd'T'HH:mm:ss'Z'",
              "units": "ms"
            }
          }, {
            "copy": {
              "from": "unmapped.FindingTypeDisplayName",
              "to": "finding_info.title"
            }
          }, {
            "copy": {
              "from": "unmapped.FindingTypeDisplayName",
              "to": "activity_name"
            }
          }, {
            "rename": {
              "from": "unmapped.FindingTypeDisplayName",
              "to": "event.type"
            }
          }, {
            "rename": {
              "from": "unmapped.channel",
              "to": "metadata.product.feature.uid"
            }
          }, {
            "copy": {
              "from": "unmapped.parser",
              "to": "metadata.transformation_info_list[0].name"
            }
          }, {
            "rename": {
              "from": "unmapped.FindingTypeID",
              "to": "finding_info.uid_alt"
            }
          }, {
            "rename": {
              "from": "unmapped.FindingTypeSeverity",
              "to": "severity_id"
            }
          }, {
            "cast": {
              "field": "severity_id",
              "type": "enum",
              "enum": {
                "Unknown": 0,
                "Informational": 1,
                "Low": 2,
                "Medium": 3,
                "High": 4,
                "Critical": 5,
                "Fatal": 6
              },
              "enum_default": 0
            }
          }, {
            "rename": {
              "from": "unmapped.InstanceID",
              "to": "finding_info.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.IntegrationDisplayName",
              "to": "finding_info.product.name"
            }
          }, {
            "rename": {
              "from": "unmapped.IntegrationID",
              "to": "finding_info.product.uid"
            }
          }, {
            "rename": {
              "from": "unmapped.IntegrationPolicyVendor",
              "to": "finding_info.product.vendor_name"
            }
          }, {
            "rename": {
              "from": "unmapped.severity",
              "to": "severity"
            }
          }, {
            "rename": {
              "from": "unmapped.message",
              "to": "raw_data"
            }
          }
        ]
      }
    ]
  }
}