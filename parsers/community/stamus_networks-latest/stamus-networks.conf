{
  attributes: {
    "dataSource.category": "security",
    "dataSource.name": "Clear NDR",
    "dataSource.vendor": "Stamus Networks",
    "class_name": "Network Activity",
    "category_name": "Network Activity"
  },
  formats: [
    {
      id: "EverythingElse",
      format: "${parse=json}$",
      rewrites: [
        {
          input: "flowSrc_port",
          output: "src.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowSrc_ip",
          output: "src.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowDest_port",
          output: "dst.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowDest_ip",
          output: "dst.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "event_type",
          output: "event.type",
          match: ".*",
          replace: "$0"
        },
        {
          input: "alertSignature",
          output: "activity_name",
          match: ".*",
          replace: "$0"
        }
        ],
      repeat: true
    },
    {
      id:"flow",
      format: ".*type\":\"flow",
      rewrites: [
        {
          input: "src_port",
          output: "src.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "src_ip",
          output: "src.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "dest_port",
          output: "dst.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "dest_ip",
          output: "dst.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "event_type",
          output: "event.type",
          match: ".*",
          replace: "$0"
        }
        ],
      halt: true
    },
    {
      id: "Alert",
      format: ".*type\":\"alert",
      halt: true,
      rewrites: [
        {
          input: "flowSrc_port",
          output: "src.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowSrc_ip",
          output: "src.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowDest_port",
          output: "dst.port.number",
          match: ".*",
          replace: "$0"
        },
        {
          input: "flowDest_ip",
          output: "dst.ip.address",
          match: ".*",
          replace: "$0"
        },
        {
          input: "event_type",
          output: "event.type",
          match: ".*",
          replace: "$0"
        },
        {
          input: "alertSignature",
          output: "activity_name",
          match: ".*",
          replace: "$0"
        },
        {
          input: "alert.action",
          output: "alert.action",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.category",
          output: "alert.category",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.gid",
          output: "alert.gid",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata",
          output: "event.additional_info",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.affected_product",
          output: "alert.product_name",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.attack_target",
          output: "attack.target",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.created_at",
          output: "alert.creation_time",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.cve",
          output: "vulnerability.cve_id",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.deployment",
          output: "event.deployment_environment",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.former_category",
          output: "alert.category_previous",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.lateral_function",
          output: "network.lateral_movement_function",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.lateral_key",
          output: "network.lateral_movement_key",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.lateral_asset",
          output: "asset.lateral_asset",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.malware_family",
          output: "malware.family_name",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.mitre_tactic_id",
          output: "attack.tactic_id",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.mitre_tactic_name",
          output: "attack.tactic_name",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.mitre_technique_id",
          output: "attack.technique_id",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.mitre_technique_name",
          output: "attack.technique_name",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.nrd_asset",
          output: "asset.nrd_asset",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.nrd_key",
          output: "attack.nrd_key",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.nrd_period",
          output: "attack.nrd_period",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.performance_impact",
          output: "system.performance_impact",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.provider",
          output: "event.provider",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.signature_severity",
          output: "alert.severity",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.source",
          output: "alert.source",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.stamus_classification",
          output: "classification.label",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.tag",
          output: "event.tag",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.metadata.updated_at",
          output: "alert.last_update_time",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.rev",
          output: "alert.revision_number",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.severity",
          output: "alert.severity",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.signature",
          output: "alert.signature",
          match: ".*",
          replace: "$0"
        }, {
          input: "alert.signature_id",
          output: "alert.signature_id",
          match: ".*",
          replace: "$0"
        }, {
          input: "app_proto",
          output: "network.application_protocol",
          match: ".*",
          replace: "$0"
        }, {
          input: "app_proto_expected",
          output: "network.expected_application_protocol",
          match: ".*",
          replace: "$0"
        }, {
          input: "app_proto_orig",
          output: "network.original_application_protocol",
          match: ".*",
          replace: "$0"
        }, {
          input: "app_proto_tc",
          output: "network.transported_protocol",
          match: ".*",
          replace: "$0"
        }, {
          input: "dest_ip",
          output: "network.destination.ip",
          match: ".*",
          replace: "$0"
        }, {
          input: "dest_port",
          output: "network.destination.port",
          match: ".*",
          replace: "$0"
        }, {
          input: "metadata",
          output: "event.metadata",
          match: ".*",
          replace: "$0"
        }, {
          input: "metadata.flowbits",
          output: "event.flowbits",
          match: ".*",
          replace: "$0"
        }, {
          input: "packet",
          output: "network.packet",
          match: ".*",
          replace: "$0"
        }, {
          input: "packet_info",
          output: "network.packet_info",
          match: ".*",
          replace: "$0"
        }, {
          input: "packet_info.linktype",
          output: "network.packet_info.linktype",
          match: ".*",
          replace: "$0"
        }, {
          input: "payload",
          output: "network.packet.payload",
          match: ".*",
          replace: "$0"
        }, {
          input: "payload_printable",
          output: "network.packet.payload_printable",
          match: ".*",
          replace: "$0"
        }, {
          input: "pcap_cnt",
          output: "network.pcap_count",
          match: ".*",
          replace: "$0"
        }, {
          input: "pkt_src",
          output: "network.packet.source",
          match: ".*",
          replace: "$0"
        }, {
          input: "proto",
          output: "network.protocol",
          match: ".*",
          replace: "$0"
        }, {
          input: "src_ip",
          output: "network.source.ip",
          match: ".*",
          replace: "$0"
        }, {
          input: "src_port",
          output: "network.source.port",
          match: ".*",
          replace: "$0"
        }, {
          input: "stream",
          output: "network.stream_id",
          match: ".*",
          replace: "$0"
        }, {
          input: "vlan",
          output: "network.vlan_id",
          match: ".*",
          replace: "$0"
        }
      ]
    }
  ]
}