{
  "attributes": {
    "dataSource.category": "security",
    "dataSource.name": "Cloud Security",
    "dataSource.vendor": "Wiz",
    "metadata.product.name": "Cloud Security",
    "metadata.product.vendor_name": "Wiz",
    "metadata.version": "1.0.0"
  },
  "formats": [
    {
      "format": "$unmapped.{parse=gron}$",
      "rewrites": [
        {
          "input": "unmapped.timestamp",
          "output": "timestamp",
          "match": ".*",
          "replace": "$0"
        }
      ]
    }
  ],
  "mappings": {
    "version": 1,
    "mappings": [
      {
        "predicate": "true",
        "transformations": [
          {
            "copy": {
              "from": "unmapped.timestamp",
              "to": "time"
            }
          },
          {
            "cast": {
              "field": "time",
              "type": "iso8601TimestampToEpochSec"
            }
          },
          {
            "constant": { "value": 2001, "field": "class_uid" }
          },
          {
            "constant": { "value": "Security Finding", "field": "class_name" }
          },
          {
            "constant": { "value": 2, "field": "category_uid" }
          },
          {
            "constant": { "value": "Findings", "field": "category_name" }
          },
          {
            "copy": { "from": "unmapped.type_uid", "to": "type_uid" }
          },
          {
            "constant": {
              "value": "Security Finding: Other",
              "field": "type_name",
              "predicate": "type_uid = '200199' OR type_uid = 200199"
            }
          },
          {
            "copy": { "from": "unmapped.activity_id", "to": "activity_id" }
          },
          {
            "constant": {
              "value": "Other",
              "field": "activity_name",
              "predicate": "activity_id = '99' OR activity_id = 99"
            }
          },
          {
            "copy": { "from": "unmapped.updatedAt", "to": "metadata.original_time" }
          },
          {
            "copy": { "from": "unmapped.createdAt", "to": "metadata.original_time", "predicate": "metadata.original_time = '' OR metadata.original_time = null" }
          }
        ]
      }
    ]
  }
}