{
  "duration": "24h",
  "configType": "TABBED",
  "tabs": [{
      "tabName": "HTTP & CDN",
      "graphs": [
        {
          "title": "Total Requests",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests'\n| group count = count()",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 6,
  w: 15,
  x: 0,
  y: 0
}
        },
        {
          "title": "Total Bandwidth (GB)",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' (http_request.length = * or http_response.body_length = *)\n| group total_bytes = sum(http_request.length + http_response.body_length)\n| let total_gb = total_bytes / 1024/1024/1024 \n| columns total_gb",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 6,
  w: 15,
  x: 15,
  y: 0
},
          options: {precision: 4},
          trendConfig: {
            enabled: false,
            indicators: {
              arrow: {enabled: true},
              number: {
                calculationType: "ABSOLUTE",
                enabled: true
              },
              upwardsMeaning: "POSITIVE"
            }
          }
        },
        {
          "title": "Cache Hit Ratio (%)",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' unmapped.CacheCacheStatus= * \n| group hits = count(unmapped.CacheCacheStatus='hit'), total = count()\n| let cache_ratio = (hits / total) * 100\n| columns cache_ratio",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 6,
  w: 15,
  x: 30,
  y: 0
},
          trendConfig: {
            enabled: false,
            indicators: {
              arrow: {enabled: true},
              number: {
                calculationType: "ABSOLUTE",
                enabled: true
              },
              upwardsMeaning: "POSITIVE"
            }
          },
          options: {
  format: "auto",
  precision: "0",
  suffix: "%"
}
        },
        {
          "title": "4xx/5xx Error Rate (%)",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_response.status = *\n| let http_response.status = number(http_response.status)\n| group errors = count(http_response.status >= 400), total = count()\n| let error_ratio = (errors / total) * 100\n| columns error_ratio",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 6,
  w: 15,
  x: 45,
  y: 0
},
          trendConfig: {
            enabled: false,
            indicators: {
              arrow: {enabled: true},
              number: {
                calculationType: "ABSOLUTE",
                enabled: true
              },
              upwardsMeaning: "POSITIVE"
            }
          },
          options: {
            format: "auto",
            precision: "0",
            suffix: "%"
          }
        },
        {
          "title": "Request Trend Over Time",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests'\n| group count = count() by timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 30,
  x: 0,
  y: 6
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Bandwidth Trend Over Time (MB)",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' (http_request.length = * or http_response.body_length = *)\n| group mb = sum(http_request.length + http_response.body_length) / 1024 / 1024 by timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 30,
  x: 30,
  y: 6
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Cache Status Breakdown",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' unmapped.CacheCacheStatus= *\n| group count = count() by unmapped.CacheCacheStatus \n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 12,
  w: 30,
  x: 0,
  y: 16
},
          dataLabelType: "PERCENTAGE",
          maxPieSlices: 10,
          totalNumberConfig: {}
        },
        {
          "title": "HTTP Response Code Breakdown",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_response.status = *\n| group count = count() by http_response.status\n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 12,
  w: 30,
  x: 30,
  y: 16
}
        },
        {
          "title": "Top 20 Client IPs",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' src_endpoint.ip = *\n| group count = count() by src_endpoint.ip\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 58
}
        },
        {
          "title": "Top 20 Requested Hostnames",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_request.url.hostname = *\n| group count = count() by http_request.url.hostname\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 58
}
        },
        {
          "title": "Top 20 Requested Paths",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_request.url.path = *\n| group count = count() by http_request.url.path\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 43
}
        },
        {
          "title": "Top 20 User Agents",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_request.user_agent = *\n| group count = count() by http_request.user_agent\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 73
}
        },
        {
          "title": "Traffic by Country",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' src_endpoint.location.country = *\n| group count = count() by src_endpoint.location.country\n| sort -count",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 73
}
        },
        {
          "title": "Top 20 Cache Miss URLs",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' unmapped.CacheCacheStatus != 'hit'\n| group count = count(unmapped.CacheCacheStatus) by http_request.url.hostname, http_request.url.path,unmapped.CacheCacheStatus\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 43
}
        },
        {
          "title": "Top 20 404 Not Found URLs",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_response.status = 404\n| group count = count() by http_request.url.path, http_request.referrer\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 28
}
        },
        {
          "title": "Top 20 5xx Server Error URLs",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' http_response.status >= 500\n| group count = count() by http_request.url.hostname, http_request.url.path\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 28
}
        }
      ]
    },
{
      "tabName": "WAF & DDoS",
      "graphs": [
        {
          "title": "Total WAF Blocks",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests', 'Firewall events','Gateway HTTP' ) action = 'block'\n| group count = count()",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 6,
  i: "0",
  minH: 3,
  minW: 6,
  w: 30,
  x: 0,
  y: 0
},
          trendConfig: {
  enabled: true,
  indicators: {
    arrow: {enabled: true},
    number: {
      calculationType: "ABSOLUTE",
      enabled: true
    },
    upwardsMeaning: "POSITIVE"
  }
}
        },
        {
          "title": "Attack Scores Trending (Average)",
          "query": "dataSource.cloudflare_dataset = 'HTTP Requests' risk_score = *\n| group \nWAFAttackScore = average(risk_score),\nWAFRCEAttackScore = average(unmapped.WAFRCEAttackScore), \nWAFSQLiAttackScore = average(unmapped.WAFSQLiAttackScore), \nWAFXSSAttackScore = average(unmapped.WAFXSSAttackScore)\nby timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 30,
  x: 0,
  y: 6
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "WAF Action Trend",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests', 'Firewall events','Gateway HTTP' ) action = *\n| group count = count() by timestamp = timebucket(), action\n| transpose action",
          "graphStyle": "line",
          "layout": {
  h: 12,
  i: "2",
  minH: 3,
  minW: 6,
  w: 30,
  x: 30,
  y: 0
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Top 20 Blocked IPs",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests', 'Firewall events','Gateway HTTP' ) action = 'block'\n| group count = count() by src_endpoint.ip, src_endpoint.location.country\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  i: "3",
  minH: 3,
  minW: 6,
  w: 30,
  x: 0,
  y: 16
}
        },
        {
          "title": "Top 20 Blocked Hostnames",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests', 'Firewall events','Gateway HTTP' ) action = 'block' http_request.url.hostname = *\n| group count = count() by http_request.url.hostname\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  i: "4",
  minH: 3,
  minW: 6,
  w: 30,
  x: 30,
  y: 12
}
        },
        {
          "title": "Top 20 Blocked URLs",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests', 'Firewall events','Gateway HTTP' ) action = 'block' http_request.url.hostname = *\n| group count = count() by http_request.url.hostname, http_request.url.path\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  i: "5",
  minH: 3,
  minW: 6,
  w: 30,
  x: 0,
  y: 31
}
        },
        {
          "title": "WAF Rule Source Breakdown",
          "query": "dataSource.cloudflare_dataset in ('HTTP Requests','Firewall events') firewall_rule.desc  = *\n| group count = count() by firewall_rule.desc \n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 15,
  i: "6",
  minH: 3,
  minW: 6,
  w: 30,
  x: 30,
  y: 27
},
          dataLabelType: "PERCENTAGE",
          maxPieSlices: 10,
          totalNumberConfig: {}
        },
        {
          "title": "DDoS Verdict Trend",
          "query": "dataSource.cloudflare_dataset = 'Network Analytics Logs' activity_name = *\n| group count = count() by timestamp = timebucket(), activity_name\n| transpose activity_name",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 60,
  x: 0,
  y: 46
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "DDoS Attack Vectors",
          "query": "dataSource.cloudflare_dataset = 'Network Analytics Logs' malware\\[0\\].name != ''\n| group count = count() by malware\\[0\\].name\n| sort -count\n| limit 20",
          "graphStyle": "pie",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 56
},
          dataLabelType: "PERCENTAGE",
          maxPieSlices: 10,
          totalNumberConfig: {}
        },
        {
          "title": "Top 20 DDoS Attacker IPs",
          "query": "dataSource.cloudflare_dataset = 'Network Analytics Logs'\n| group count = count() by src_endpoint.ip, src_endpoint.location.country\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 56
}
        }
      ]
    },
{
      "tabName": "DNS",
      "graphs": [
        {
          "title": "Total DNS Queries",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS')\n| group count = count()",
          "graphStyle": "number",
          "sparklineConfig": {
            "enabled": true
          },
          "layout": {
  h: 10,
  w: 15,
  x: 0,
  y: 0
}
        },
        {
          "title": "DNS Query Trend",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS')\n| group count = count() by timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 45,
  x: 15,
  y: 0
}
        },
        {
          "title": "DNS Response Code Breakdown",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS') rcode_id = *\n| group count = count() by rcode_id  // 0=NOERROR, 3=NXDOMAIN\n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 12,
  w: 30,
  x: 0,
  y: 10
}
        },
        {
          "title": "Top 20 Queried Domains",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS') query.hostname = *\n| group count = count() by query.hostname\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 10
}
        },
        {
          "title": "Top 20 DNS Clients (by IP)",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS') src_endpoint.ip = *\n| group count = count() by src_endpoint.ip\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 22
}
        },
        {
          "title": "Top 20 DNS Clients (by User - Gateway)",
          "query": "dataSource.cloudflare_dataset = 'Gateway DNS' actor.user.email_addr = *\n| group count = count() by actor.user.email_addr\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 25
}
        },
        {
          "title": "Top 20 Non-Existent (NXDOMAIN) Queries",
          "query": "dataSource.cloudflare_dataset in ('DNS logs', 'Gateway DNS') rcode_id = 3\n| group count = count() by query.hostname\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 37
}
        }
      ]
    },
{
      "tabName": "Zero Trust",
      "graphs": [
        {
          "title": "Access Attempts (Allowed vs. Blocked)",
          "query": "(dataSource.cloudflare_dataset in ('Gateway HTTP', 'Gateway Network') action = *) or (dataSource.cloudflare_dataset = 'Access requests' activity_name = *)\n| let access_decision = (dataSource.cloudflare_dataset == 'Access requests' ? activity_name : action)\n| group count = count() by access_decision\n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 10,
  w: 30,
  x: 0,
  y: 0
}
        },
        {
          "title": "Login Trend (Allowed vs. Blocked)",
          "query": "(dataSource.cloudflare_dataset in ('Gateway HTTP', 'Gateway Network') action = *) or (dataSource.cloudflare_dataset = 'Access requests' activity_name = *)\n| let access_decision = (dataSource.cloudflare_dataset == 'Access requests' ? activity_name : action)\n| group allowed = count(access_decision='allow' or access_decision='login'), blocked = count(access_decision='block' or access_decision='deny') by timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 30,
  x: 30,
  y: 0
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Top 20 Allowed Users",
          "query": "(dataSource.cloudflare_dataset in ('Gateway HTTP', 'Gateway Network') action = 'allow' actor.user.email_addr = *) or (dataSource.cloudflare_dataset = 'Access requests' activity_name = 'login' user.email_addr = *)\n| let user_email = (dataSource.cloudflare_dataset == 'Access requests' ? user.email_addr : actor.user.email_addr)\n| group count = count() by user_email\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 10
}
        },
        {
          "title": "Top 20 Blocked Users",
          "query": "(dataSource.cloudflare_dataset in ('Gateway HTTP', 'Gateway Network') action = 'block' actor.user.email_addr = *) or (dataSource.cloudflare_dataset = 'Access requests' activity_name = 'deny' user.email_addr = *)\n| let user_email = (dataSource.cloudflare_dataset == 'Access requests' ? user.email_addr : actor.user.email_addr)\n| group count = count() by user_email\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 10
}
        },
        {
          "title": "Top 20 Accessed Applications (via HTTP Gateway)",
          "query": "dataSource.cloudflare_dataset = 'Gateway HTTP' action='allow' http_request.url.hostname = *\n| group count = count() by http_request.url.hostname\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 25
}
        },
        {
          "title": "Device OS Breakdown",
          "query": "dataSource.cloudflare_dataset = 'Device posture results' device.type = *\n| group count = count() by device.type\n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 10,
  w: 30,
  x: 30,
  y: 25
}
        },
        {
          "title": "Device OS Versions",
          "query": "dataSource.cloudflare_dataset = 'Device posture results'\n| group count = count() by device.type, device.os.version\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 40
}
        },
        {
          "title": "Latest Posture Check per User/Device",
          "query": "dataSource.cloudflare_dataset = 'Device posture results'\n| group latest_check = max(timestamp) by actor.user.email_addr, device.name, device.type, device.os.version\n| sort latest_check",
          "graphStyle": "",
          "layout": {
  h: 20,
  w: 30,
  x: 30,
  y: 35
}
        }
      ]
    },
{
      "tabName": "Audit Logs",
      "graphs": [
        {
          "title": "Audit Activity Trend",
          "query": "dataSource.cloudflare_dataset in ('Audit Logs V2', 'Audit Logs')\n| group count = count() by timestamp = timebucket()",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 60,
  x: 0,
  y: 0
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Audit Activity by User",
          "query": "dataSource.cloudflare_dataset in ('Audit Logs V2', 'Audit Logs') actor.user.email_addr = *\n| group count = count() by actor.user.email_addr\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 10
}
        },
        {
          "title": "Audit Action Breakdown",
          "query": "dataSource.cloudflare_dataset in ('Audit Logs V2', 'Audit Logs') activity_name = *\n| group count = count() by activity_name\n| sort -count",
          "graphStyle": "pie",
          "layout": {
  h: 12,
  w: 30,
  x: 30,
  y: 10
}
        },
        {
          "title": "Failed Audit Actions (V2 Logs)",
          "query": "dataSource.cloudflare_dataset = 'Audit Logs V2' status_id = 2\n| group count = count() by actor.user.email_addr, activity_name\n| sort -count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 25
}
        },
        {
          "title": "Recent Audit Events",
          "query": "dataSource.cloudflare_dataset in ('Audit Logs V2', 'Audit Logs')\n| columns timestamp, actor.user.email_addr, device.ip, activity_name, status_id\n| sort -timestamp\n| limit 100",
          "graphStyle": "",
          "layout": {
  h: 18,
  w: 30,
  x: 30,
  y: 22
}
        }
      ]
    },
{
      "tabName": "Email Threats",
      "graphs": [
        {
          "title": "Email Volume & Dispositions",
          "query": "dataSource.cloudflare_dataset = 'Email Security Alerts' disposition = *\n| group count = count() by timestamp = timebucket(), disposition\n| transpose disposition",
          "graphStyle": "line",
          "layout": {
  h: 10,
  w: 60,
  x: 0,
  y: 0
},
          lineSmoothing: "straightLines"
        },
        {
          "title": "Email Threat Breakdown",
          "query": "dataSource.cloudflare_dataset = 'Email Security Alerts'\n| group count=count() by metadata.labels[*]\n| columns metadata.labels = 'threat_category', count",
          "graphStyle": "pie",
          "layout": {
  h: 15,
  w: 30,
  x: 0,
  y: 10
},
          dataLabelType: "PERCENTAGE",
          maxPieSlices: 10,
          totalNumberConfig: {}
        },
        {
          "title": "Top Targeted Recipients (Malicious)",
          "query": "dataSource.cloudflare_dataset = 'Email Security Alerts' disposition != 'unset'\n| group count=count() by email.to[*]\n| sort -count\n| columns email.to = 'recipent', count\n| limit 20",
          "graphStyle": "",
          "layout": {
  h: 15,
  w: 30,
  x: 30,
  y: 10
}
        }
      ]
    }],
  "filters": [],
  description: ""
}
